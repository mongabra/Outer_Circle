<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OuterCircle</title>

  <style>
    :root{
      --pale-aqua: #cfeef0;
      --aqua-contrast: #9fe0e2;
      --accent: #5bb6b8;
      --muted: #6b7c7c;
      --card-bg: rgba(255,255,255,0.95);
      --shadow: 0 10px 30px rgba(6,50,58,0.09);
      --radius: 18px;
      --text: #0b2224;
      --logo-size: 64px;
    }

    html,body{
      height:100%;
      margin:0;
      padding:0;
      font-family: 'Segoe UI', Arial, sans-serif;
      color: var(--text);
      background-color: var(--pale-aqua);
      position: relative;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* add faint background image overlay (30% opacity) */
    body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: url("images/OuterCircle.png") center top/contain no-repeat; /* changed cover â†’ contain */
    opacity: 1; /* your desired visibility */
    background-size: 100%; /* zoom control (100% = natural fit, 130% slightly zoomed in) */
    background-position: center 32%; /* move up/down to align banner */
    z-index: 1;
}
   

    body::after{
      content: "";
      position: fixed;
      inset: 0;
      background: linear-gradient(rgba(207,238,240,0.36), rgba(234,247,247,0.36));
      backdrop-filter: blur(4px);
      z-index: 0;
      pointer-events: none;
    }

    .container {
      max-width: 680px;
      margin: 32px auto;
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 44px 36px 32px 36px;
      min-height: 92vh;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }

    .container > * { position: relative; z-index: 2; }

    .header-row {
      display: flex;
      align-items: center; /* centered vertically */
      gap: 20px;
      margin-bottom: 16px;
    }

    .logo {
      width: var(--logo-size);
      height: var(--logo-size);
      border-radius: 12px;
      background: linear-gradient(135deg, var(--pale-aqua), var(--aqua-contrast));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
      font-weight: 700;
      color: #fff;
      box-shadow: 0 4px 24px rgba(0,123,167,0.13);
      flex-shrink: 0;
      letter-spacing: 1px;
      overflow: hidden;
      position: relative;
      margin-top: 0;
      transition: transform 0.22s ease, box-shadow 0.22s ease;
      cursor: default;
    }

    .logo:hover {
      transform: rotate(4deg) scale(1.05);
      box-shadow: 0 10px 34px rgba(91,182,184,0.22);
    }

    .header-text-block {
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .header-title {
      font-size: 2.3rem;
      font-weight: bold;
      color: var(--text);
      letter-spacing: 0.01em;
      margin-bottom: 2px;
      line-height: 1.13;
    }

    .header-sub {
      color: var(--muted);
      font-size: 1rem;
      font-weight: 400;
      margin-top: 2px;
    }

    /* keep your original text and form styling */
    .main-content {
      margin-top: 16px;
      margin-bottom: 16px;
      flex: 1;
    }

    .main-content h2 {
      font-size: 1.48rem;
      font-weight: bold;
      margin: 0 0 8px 0;
      color: var(--text);
    }

    .why-text {
      font-size: 1rem;
      color: var(--text);
      font-weight: 400;
      line-height: 1.6;
      margin: 0 0 8px 0;
    }

    .why-headline {
      font-weight: 500;
      font-size: 1rem;
      margin-bottom: 0.2em;
      color: var(--text);
      display: block;
    }

    .form-group {
      margin: 28px 0 0 0;
      display: flex;
      flex-direction: column;
      gap: 8px;
      position: relative;
    }

    label {
      font-size: 1rem;
      font-weight: 600;
      color: var(--accent);
      margin-bottom: 3px;
    }

    .textarea-wrapper { position: relative; width: 100%; display: flex; }

    textarea {
      border-radius: 12px;
      border: 2px solid rgba(207,238,240,0.7);
      resize: vertical;
      min-height: 110px;
      font-size: 1rem;
      padding: 12px 14px;
      background: #fff;
      color: var(--text);
      font-family: inherit;
      transition: border 0.21s;
      box-shadow: 0 3px 12px rgba(0,123,167,0.04);
      width: 100%;
      box-sizing: border-box;
    }

    textarea:focus { border-color: var(--accent); outline: none; }

    .ai-spell-btn {
      position: absolute;
      bottom: 12px;
      right: 12px;
      width: 34px;
      height: 34px;
      background: var(--accent);
      border: none;
      border-radius: 50%;
      color: #fff;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,123,167,0.14);
      transition: background 0.18s, transform 0.12s;
      z-index: 5;
    }

    .ai-spell-btn:hover { transform: translateY(-2px); background: #3fa6a8; }
    .ai-spell-btn[disabled] { opacity: 0.5; cursor: not-allowed; }

    .spell-feedback {
      margin-top: 5px;
      min-height: 18px;
      font-size: 0.97rem;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .ai-spinner {
      width: 18px;
      height: 18px;
      border: 2.5px solid rgba(207,238,240,0.8);
      border-top: 2.5px solid var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      display: inline-block;
      vertical-align: middle;
      margin-left: 2px;
    }

    @keyframes spin { to { transform: rotate(360deg);} }

    .char-count { font-size: 0.97rem; color: var(--muted); margin: 0 0 8px 2px; }

    .row { display: flex; gap: 20px; margin: 12px 0 0 0; align-items: flex-end; }
    .row .col { flex: 1; }

    select, input[type="text"] {
      width: 100%;
      border-radius: 9px;
      padding: 10px 12px;
      border: 1.5px solid rgba(207,238,240,0.7);
      background: #f6fcfd;
      color: var(--text);
      font-size: 1rem;
      margin-top: 2px;
      margin-bottom: 0;
      box-shadow: 0 2px 8px rgba(0,123,167,0.03);
      transition: border 0.18s;
    }

    select:focus, input[type="text"]:focus { border-color: var(--accent); outline: none; }

    .note { color: var(--muted); font-size: 0.98rem; margin: 10px 0 0 0; }

    .button-row {
      display: flex;
      gap: 16px;
      justify-content: flex-end;
      margin-top: 18px;
      margin-bottom: 10px;
    }

    .btn {
      border: none;
      border-radius: 10px;
      padding: 12px 28px;
      font-size: 1.05rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 5px 14px rgba(0,123,167,0.07);
      transition: transform 0.12s, box-shadow 0.14s, background 0.14s;
    }

    .btn-primary {
      background: linear-gradient(180deg,var(--accent), #3fa6a8);
      color: #fff;
    }

    .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 10px 26px rgba(63,166,168,0.12); }

    .btn-secondary {
      background: #fff;
      color: var(--accent);
      border: 1.5px solid rgba(207,238,240,0.7);
    }

    .btn-secondary:hover { background: rgba(207,238,240,0.6); }

    .footer {
      color: var(--muted);
      text-align: center;
      font-size: 1rem;
      margin-top: 30px;
      padding: 10px 0 0 0;
      border-top: 1.5px solid rgba(208,242,246,0.6);
      letter-spacing: 0.01em;
    }

    .readonly { background-color: #e6f7fb !important; color: #888 !important; cursor: not-allowed; }

    @media (max-width: 850px) {
      .container { padding: 14px 2vw 22px 2vw; }
      .header-title { font-size: 1.8rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header-row">
      <div class="logo">OC</div>
      <div class="header-text-block">
        <div class="header-title">OuterCircle</div>
        <div class="header-sub">There is light in all of us, and that is what guides us and gives us hope.</div>
      </div>
    </div>

    <div class="main-content">
      <h2>Why We Exist:</h2>

      <div class="why-text">
        <span class="why-headline">Finding Your Confident Voice</span>
        <p>
          We believe that healing begins with a single word. For too long, the stigma around mental health has forced people into the shadows.
          We want to challenge that. We want to give you the platform to share your darkest thoughts or your smallest victories without the worry of exposure.
        </p>
      </div>

      <form autocomplete="off" method="post" action="/submit-message" id="anonForm">
        <div class="form-group">
          <label for="user-code">Your Unique Code</label>
          <input type="text" id="user-code" name="user-code" maxlength="4" required readonly class="readonly" value="{{ code }}" placeholder="Your unique code" />
          <div class="note">This code links your anonymous messages. Keep it safe and reuse it for every message. <strong>Do not share your code.</strong></div>
        </div>

        <div class="form-group">
          <label for="anon-message">Message</label>
          <div class="textarea-wrapper">
            <textarea id="anon-message" name="anon-message" maxlength="10000" required placeholder="Type your anonymous message here..." oninput="document.getElementById('charCount').textContent=this.value.length;"></textarea>
            <button type="button" class="ai-spell-btn" id="spellBtn" title="Check spelling and grammar"><span id="spellBtnIcon">ðŸª„</span></button>
          </div>
          <div class="char-count">Message length: <span id="charCount">0</span>/10000</div>
          <div class="spell-feedback" id="spellFeedback"></div>
        </div>

        <div class="row">
          <div class="col">
            <label for="sensitivity">Sensitivity</label>
            <select id="sensitivity" name="sensitivity">
              <option value="normal" selected>Normal</option>
              <option value="sensitive">Sensitive</option>
              <option value="urgent">Urgent</option>
            </select>
          </div>

          <div class="col">
            <label for="delivery">Deliver to</label>
            <select id="delivery" name="delivery">
              <option value="team">Team Inbox</option>
              <option value="moderators">Moderators</option>
              <option value="feedback">Feedback Box</option>
            </select>
          </div>
        </div>

        <div class="note">No account, no name â€” truly anonymous.</div>

        <div class="button-row">
          <button type="submit" class="btn btn-primary" id="sendBtn">
            <span id="btnLabel">Send anonymously</span>
            <span id="btnSpinner" style="display:none; margin-left:8px;" class="ai-spinner"></span>
          </button>
          <button type="reset" class="btn btn-secondary" id="clearBtn">Clear</button>
        </div>
      </form>
    </div>

    <div class="footer">
      &copy; 2025. OuterCircle. All Rights Reserved.
    </div>
  </div>

  <script>
    async function aiSpellCheck(text) {
      return new Promise(resolve => {
        setTimeout(() => {
          if (!text.trim()) { resolve({corrected: "", message: "No text to check."}); return; }
          let corrected = text
            .replace(/\bteh\b/gi, "the")
            .replace(/\bi\b/g, "I")
            .replace(/\bdont\b/gi, "don't")
            .replace(/\brecieve\b/gi, "receive");
          if (corrected !== text) {
            resolve({ corrected, message: "AI suggestions applied!" });
          } else {
            resolve({ corrected: text, message: "No spelling or grammar mistakes found." });
          }
        }, 1100);
      });
    }

    const spellBtn = document.getElementById('spellBtn');
    const spellBtnIcon = document.getElementById('spellBtnIcon');
    const spellFeedback = document.getElementById('spellFeedback');
    const anonMessage = document.getElementById('anon-message');
    const charCount = document.getElementById('charCount');
    const sendBtn = document.getElementById('sendBtn');
    const btnLabel = document.getElementById('btnLabel');
    const btnSpinner = document.getElementById('btnSpinner');
    const form = document.getElementById('anonForm');
    const clearBtn = document.getElementById('clearBtn');

    spellBtn.addEventListener('click', async () => {
      spellBtn.disabled = true;
      const spinner = document.createElement('span');
      spinner.className = 'ai-spinner';
      spinner.style.marginLeft = '6px';
      spellBtn.appendChild(spinner);
      spellBtnIcon.style.display = 'none';
      spellFeedback.textContent = "Checking...";

      try {
        const res = await aiSpellCheck(anonMessage.value);
        spellFeedback.textContent = res.message || "";
        if (res.corrected && res.corrected !== anonMessage.value) {
          anonMessage.value = res.corrected;
          charCount.textContent = anonMessage.value.length;
        }
      } finally {
        spinner.remove();
        spellBtnIcon.style.display = '';
        spellBtn.disabled = false;
      }
    });

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      if (!anonMessage.value.trim()) {
        spellFeedback.textContent = "Please enter a message before sending.";
        spellFeedback.style.color = "var(--muted)";
        return;
      }

      btnLabel.textContent = "Sending...";
      btnSpinner.style.display = "inline-block";
      sendBtn.disabled = true;

      setTimeout(() => {
        spellFeedback.textContent = "Message sent anonymously âœ“";
        spellFeedback.style.color = "var(--accent)";
        btnLabel.textContent = "Send anonymously";
        btnSpinner.style.display = "none";
        sendBtn.disabled = false;
        form.reset();
        charCount.textContent = "0";
      }, 1400);
    });

    clearBtn.addEventListener('click', () => {
      anonMessage.value = "";
      charCount.textContent = "0";
      spellFeedback.textContent = "";
    });
  </script>
</body>
</html>
